package listaPolinomios;

import java.util.Scanner;

public class PolinomioCircular {

    static class Nodo {
        double coeficiente;
        int exponente;
        Nodo siguiente;

        public Nodo(double coef, int exp) {
            this.coeficiente = coef;
            this.exponente = exp;
            this.siguiente = null;
        }
    }

    static class ListaCircularPolinomio {
        private Nodo ultimo;

        public ListaCircularPolinomio() {
            ultimo = null;
        }

        public void insertarTermino(double coeficiente, int exponente) {
            Nodo nuevo = new Nodo(coeficiente, exponente);
            if (ultimo == null) {
                ultimo = nuevo;
                ultimo.siguiente = ultimo;
            } else {
                nuevo.siguiente = ultimo.siguiente;
                ultimo.siguiente = nuevo;
                ultimo = nuevo;
            }
        }

        public void mostrarPolinomio() {
            if (ultimo == null) {
                System.out.println(" El polinomio está vacío.");
                return;
            }
            Nodo actual = ultimo.siguiente;
            System.out.print("P(x) = ");
            do {
                double coef = actual.coeficiente;
                int exp = actual.exponente;
                if (coef >= 0 && actual != ultimo.siguiente) System.out.print("+ ");
                System.out.print(coef);
                if (exp > 0) System.out.print("x^" + exp + " ");
                else System.out.print(" ");
                actual = actual.siguiente;
            } while (actual != ultimo.siguiente);
            System.out.println();
        }

        public double evaluar(double x) {
            if (ultimo == null) return 0.0;
            double resultado = 0.0;
            Nodo actual = ultimo.siguiente;
            do {
                resultado += actual.coeficiente * Math.pow(x, actual.exponente);
                actual = actual.siguiente;
            } while (actual != ultimo.siguiente);
            return resultado;
        }
    }

    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        ListaCircularPolinomio polinomio = new ListaCircularPolinomio();

        
        System.out.println("Ingrese los términos del polinomio (coeficiente y exponente).");
        System.out.println("Ejemplo: 3 4  -4 2  11 0 representa 3x^4 - 4x^2 + 11");
        System.out.println("Cuando termine, escriba 'fin'.");

        while (true) {
            System.out.print("Coeficiente (o 'fin'): ");
            String entrada = sc.next();
            if (entrada.equalsIgnoreCase("fin")) break;
            try {
                double coef = Double.parseDouble(entrada);
                System.out.print("Exponente: ");
                int exp = sc.nextInt();
                polinomio.insertarTermino(coef, exp);
            } catch (NumberFormatException e) {
                System.out.println(" Entrada inválida. Intente nuevamente.");
            }
        }

        System.out.println("\n Polinomio circular ingresado:");
        polinomio.mostrarPolinomio();

        System.out.println("\n Evaluación del Polinomio");
        System.out.println("-------------------------------");
        System.out.printf("%6s | %10s\n", "x", "P(x)");
        System.out.println("-------------------------------");

        for (double x = 0.0; x <= 5.0; x += 0.5) {
            double resultado = polinomio.evaluar(x);
            System.out.printf("%6.2f | %10.4f\n", x, resultado);
        }

        System.out.println("-------------------------------");
        System.out.println("Evaluación completada con éxito.");
        sc.close();
    }
}
